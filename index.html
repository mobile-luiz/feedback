<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Feedback | Diffs e Ocorr√™ncias da Qualidade</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- Tela de Login -->
<div class="login-container" id="loginScreen">
  <div class="login-logo">
    <div class="logo-icon">
      <i class="fas fa-comment-dots"></i>
    </div>
    <div>
      <h2>Registro de Feedback Diffs e Ocorrencias da qualidade</h2>
      <p class="login-subtitle">  </p>
    </div>
  </div>
  
  <form id="loginForm">
    <div class="input-group">
      <label for="loginEmail"><i class="fas fa-envelope"></i> E-mail</label>
      <input type="email" id="loginEmail" placeholder="email@empresa.com" required>
    </div>
    
    <div class="login-info">
      <p style="text-align: center; color: var(--shoppe-gray); font-size: 13px; margin: 15px 0 25px;">
        <i class="fas fa-info-circle"></i> Digite seu e-mail corporativo para acessar o sistema
      </p>
    </div>
    
    <button type="submit">
      <i class="fas fa-sign-in-alt"></i>
      Acessar Sistema
    </button>
    
    <div class="login-error" id="loginError">
      <i class="fas fa-exclamation-circle"></i>
      <span id="errorText">E-mail inv√°lido!</span>
    </div>
    
    <div class="login-success" id="loginSuccess">
      <i class="fas fa-check-circle"></i>
      <span>Login autorizado! Redirecionando...</span>
    </div>
    
    <div class="login-loading" id="loginLoading">
      <i class="fas fa-circle-notch fa-spin"></i>
      <span>Verificando credenciais...</span>
    </div>
  </form>
  
  <div class="form-footer">
    <p>Todos os direitos reservados.</p>
  </div>
</div>

<!-- Aplicativo Principal com Menu Lateral -->
<div class="app-container" id="appScreen">
  <div class="app-header">
    <div class="header-top">
      <div class="header-left">
        <button class="mobile-menu-btn" id="mobileMenuBtn">
          <i class="fas fa-bars"></i>
        </button>
        <div class="header-logo">
          <i class="fas fa-comments"></i>
        </div>
        <div class="header-title">
          <h2>Registro de Feedback</h2>
          <p>Sistema de Diffs e Ocorr√™ncias da Qualidade</p>
        </div>
      </div>
      
      <div class="user-info" id="userInfo">
        <i class="fas fa-user-circle"></i>
        <span>Usu√°rio: <strong id="loggedUser"></strong></span>
      </div>
    </div>
  </div>
  
  <div class="mobile-overlay" id="mobileOverlay"></div>
  
  <div class="main-content">
    <!-- Menu Lateral -->
    <div class="sidebar" id="sidebar">
      <div class="nav-section">
        <div class="nav-title">Navega√ß√£o</div>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="#" class="nav-link active" data-page="feedback">
              <i class="fas fa-plus-circle"></i>
              Novo Feedback
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-page="meus-feedbacks">
              <i class="fas fa-history"></i>
              Meus Feedbacks
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-page="relatorios">
              <i class="fas fa-chart-bar"></i>
              Relat√≥rios
            </a>
          </li>
        </ul>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">A√ß√µes R√°pidas</div>
        <ul class="nav-menu">
          <li class="nav-item">
            <button class="nav-link" onclick="exportarFeedbacksPDF()" style="background: none; border: none; cursor: pointer; text-align: left; width: 100%;">
              <i class="fas fa-file-pdf"></i>
              Exportar PDF
            </button>
          </li>
        </ul>
      </div>
      
      <div class="nav-section">
        <ul class="nav-menu">
          <li class="nav-item logout">
            <a href="#" class="nav-link logout" id="btnLogout">
              <i class="fas fa-sign-out-alt"></i>
              Sair
            </a>
          </li>
        </ul>
      </div>
    </div>
    
    <!-- √Årea de Conte√∫do -->
    <div class="content-area" id="contentArea">
      <!-- P√°gina: Novo Feedback -->
      <div id="page-feedback" class="page-content active">
        <h3><i class="fas fa-plus-circle"></i> Registrar Novo Feedback</h3>
        
        <div class="feedback-form-container">
          <form id="feedbackForm">
            <div class="form-section">
              <h4><i class="fas fa-user-tie"></i> Informa√ß√µes do Feedback</h4>
              
              <!-- CAMPO CAD -->
              <div class="input-group">
                <label for="cad">CAD</label>
                <input type="text" id="cad" placeholder="Digite o n√∫mero do CAD" required>
              </div>
              
              <!-- CAMPO GESTOR -->
              <div class="input-group">
                <label for="gestor">Nome do Gestor</label>
                <input type="text" id="gestor" placeholder="Quem est√° aplicando o feedback?" required>
              </div>
              
              <!-- CAMPO COLABORADOR -->
              <div class="input-group">
                <label for="colaborador">Colaborador</label>
                <select id="colaborador" required disabled>
                  <option value="">Carregando lista de colaboradores...</option>
                </select>
              </div>
              
              <!-- CAMPO TIPO DE FEEDBACK -->
              <div class="input-group">
                <label for="tipo">Tipo de Feedback</label>
                <select id="tipo" required>
                  <option value="">Selecione o tipo de feedback...</option>
                  <option value="Qualidade Putaway">üì¶ Qualidade Putaway</option>
                  <option value="Sugest√£o de Melhoria">üí° Sugest√£o de Melhoria</option>
                  <option value="Limite de SKU's">üî¢ Limite de SKU's</option>
                  <option value="Sobra">‚ûï Sobra</option>
                  <option value="Falta">‚ûñ Falta</option>
                  <option value="Embalagens">üõçÔ∏è Embalagens</option>
                  <option value="OB Verdadeiro - PNE">‚úÖ OB Verdadeiro - PNE</option>
                  <option value="OB Verdadeiro - PE">‚úÖ OB Verdadeiro - PE</option>
                  <option value="OB Falso">‚ùå OB Falso</option>
                </select>
              </div>

              <!-- CAMPO ENDERE√áO WMS -->
              <div class="input-group">
                <label for="endereco">Endere√ßo WMS</label>
                <input type="text" id="endereco" placeholder="Digite o endere√ßo" required>
              </div>

              <!-- CAMPO ENDERE√áO TRATADO -->
              <div class="input-group">
                <label for="enderecoTratado">Endere√ßo Tratado?</label>
                <select id="enderecoTratado" required>
                  <option value="">Selecione uma op√ß√£o...</option>
                  <option value="Concluido">‚úÖ Conclu√≠do</option>
                  <option value="Pendente">‚è≥ Pendente</option>
                  <option value="NA">‚ö™ NA (N√£o se aplica)</option>
                </select>
              </div>
              
              <!-- CAMPO NOTA -->
              <div class="nota-container">
                <label>Nota do Feedback</label>
                <div class="nota-display">
                  <input type="range" 
                         id="nota" 
                         min="1" 
                         max="10" 
                         step="1" 
                         value="5"
                         class="nota-slider"
                         oninput="updateNotaDisplay(this.value)">
                  <div class="nota-value" id="notaValue">5/10</div>
                </div>
                <div class="nota-labels">
                  <span>1 - Baixo</span>
                  <span>10 - Excelente</span>
                </div>
                <div class="nota-indicator">
                  <div class="nota-indicator-dot" id="notaIndicator"></div>
                  <span id="notaTexto">Neutro - Satisfat√≥rio</span>
                </div>
              </div>
              
              <!-- CAMPO MENSAGEM -->
              <div class="input-group">
                <label for="mensagem">Descri√ß√£o do Feedback</label>
                <textarea id="mensagem" placeholder="Descreva os pontos abordados no feedback, observa√ß√µes importantes, resultados esperados, etc." required></textarea>
              </div>
            </div>
            
            <!-- SE√á√ÉO ASSINATURA -->
            <div class="form-section">
              <h4><i class="fas fa-signature"></i> Assinatura do Colaborador</h4>
              
              <div class="signature-container">
                <div class="signature-label">
                  <label>Assine no espa√ßo abaixo</label>
                  <button type="button" onclick="clearSignature()">
                    <i class="fas fa-eraser"></i>
                    Limpar Assinatura
                  </button>
                </div>
                
                <div class="signature-pad" id="signaturePad">
                  <canvas id="signatureCanvas"></canvas>
                </div>
                
                <div class="signature-instructions">
                  <i class="fas fa-mouse-pointer"></i> Clique e arraste para assinar acima
                </div>
              </div>
            </div>
            
            <!-- BOT√ïES DE A√á√ÉO -->
            <div class="btn-group">
              <button type="submit" class="btn-submit" id="btnEnviar">
                <i class="fas fa-paper-plane"></i>
                Registrar Feedback
              </button>
              
              <button type="button" class="btn-submit secondary" onclick="limparFormulario()">
                <i class="fas fa-broom"></i>
                Limpar Formul√°rio
              </button>
            </div>
            
            <!-- LOADER -->
            <div class="loader" id="loader">
              <i class="fas fa-circle-notch"></i>
              Enviando feedback para o sistema...
            </div>
          </form>
          
          <div class="form-footer">
            <p><i class="fas fa-shield-alt"></i> Os dados s√£o armazenados de forma segura e confidencial.</p>
          </div>
        </div>
      </div>
      
      <!-- P√°gina: Meus Feedbacks -->
      <div id="page-meus-feedbacks" class="page-content" style="display: none;">
        <h3><i class="fas fa-history"></i> Meus Feedbacks Registrados</h3>
        
        <div class="feedbacks-container">
          <div class="feedbacks-header">
            <div>
              <h3>Hist√≥rico de Feedbacks</h3>
              <p>Visualize todos os feedbacks registrados por voc√™</p>
            </div>
            
            <div class="btn-group" style="flex-direction: row; gap: 10px;">
              <button class="btn-submit secondary" onclick="carregarMeusFeedbacks()" style="flex: 1;">
                <i class="fas fa-sync-alt"></i>
                Atualizar
              </button>
              
              <button class="btn-submit secondary" onclick="alternarVisualizacao()" id="toggleViewBtn" style="flex: 1;">
                <i class="fas fa-th-list"></i>
                Cards
              </button>
            </div>
          </div>
          
          <!-- Cards para Mobile -->
          <div id="feedbacksCards" class="feedbacks-cards">
            <div style="text-align: center; padding: 40px 20px; color: var(--text-light);">
              <i class="fas fa-history" style="font-size: 40px; margin-bottom: 15px; color: #e0e0e0;"></i>
              <h4 style="margin-bottom: 10px; color: var(--text-light);">Nenhum feedback carregado</h4>
              <p style="font-size: 14px;">Clique em "Atualizar" para carregar seus feedbacks</p>
            </div>
          </div>
          
          <!-- Tabela para Desktop -->
          <div class="feedbacks-table-container">
            <table class="feedbacks-table">
              <thead>
                <tr>
                  <th>DATA/HORA</th>
                  <th>CAD</th>
                  <th>COLABORADOR</th>
                  <th>TIPO</th>
                  <th>NOTA</th>
                  <th>ENDERE√áO WMS</th>
                  <th>ENDERE√áO TRATADO?</th>
                </tr>
              </thead>
              <tbody id="feedbacksTableBody">
                <tr>
                  <td colspan="7" style="text-align: center; padding: 40px; color: var(--text-light);">
                    <i class="fas fa-history" style="font-size: 40px; margin-bottom: 15px; color: #e0e0e0; display: block;"></i>
                    <h4 style="margin-bottom: 10px; color: var(--text-light);">Nenhum feedback carregado</h4>
                    <p style="font-size: 14px;">Clique em "Atualizar" para carregar seus feedbacks</p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="pagination" id="paginationControls" style="display: none;">
            <!-- Pagina√ß√£o ser√° inserida aqui -->
          </div>
        </div>
      </div>
      
      <!-- P√°gina: Relat√≥rios -->
      <div id="page-relatorios" class="page-content" style="display: none;">
        <h3><i class="fas fa-chart-bar"></i> Relat√≥rios e Estat√≠sticas</h3>
        
        <div class="reports-container">
          <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
              <div class="stat-header">
                <div>
                  <div class="stat-value" id="totalFeedbacks">0</div>
                  <div class="stat-label">Total de Feedbacks</div>
                </div>
                <div class="stat-icon" style="background: linear-gradient(135deg, #e53935, #ff5252);">
                  <i class="fas fa-comments"></i>
                </div>
              </div>
              <div class="stat-trend positive">
                <i class="fas fa-arrow-up"></i>
                <span>Atualizado agora</span>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-header">
                <div>
                  <div class="stat-value" id="avgNota">0.0</div>
                  <div class="stat-label">Nota M√©dia</div>
                </div>
                <div class="stat-icon" style="background: linear-gradient(135deg, #ff6f00, #ff9100);">
                  <i class="fas fa-star"></i>
                </div>
              </div>
              <div class="stat-trend positive">
                <i class="fas fa-chart-line"></i>
                <span>Desempenho</span>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-header">
                <div>
                  <div class="stat-value" id="topTipo">-</div>
                  <div class="stat-label">Tipo Mais Comum</div>
                </div>
                <div class="stat-icon" style="background: linear-gradient(135deg, #2196f3, #2979ff);">
                  <i class="fas fa-chart-pie"></i>
                </div>
              </div>
              <div class="stat-trend positive">
                <i class="fas fa-info-circle"></i>
                <span>An√°lise</span>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-header">
                <div>
                  <div class="stat-value" id="completionRate">0%</div>
                  <div class="stat-label">Taxa de Conclus√£o</div>
                </div>
                <div class="stat-icon" style="background: linear-gradient(135deg, #4caf50, #66bb6a);">
                  <i class="fas fa-check-circle"></i>
                </div>
              </div>
              <div class="stat-trend positive">
                <i class="fas fa-percentage"></i>
                <span>Efici√™ncia</span>
              </div>
            </div>
          </div>
          
          <div class="charts-grid" id="chartsGrid">
            <div style="text-align: center; padding: 40px 20px; color: var(--text-light);">
              <i class="fas fa-chart-bar" style="font-size: 40px; margin-bottom: 15px; color: #e0e0e0;"></i>
              <h4 style="margin-bottom: 10px; color: var(--text-light);">Carregando relat√≥rios...</h4>
              <p style="font-size: 14px; margin-bottom: 20px;">Registre alguns feedbacks para gerar estat√≠sticas e gr√°ficos</p>
              <button class="btn-submit" onclick="gerarRelatorios()" style="max-width: 200px; margin: 0 auto;">
                <i class="fas fa-chart-line"></i>
                Gerar Relat√≥rios
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Confirma√ß√£o -->
<div class="modal-overlay" id="confirmationModal">
  <div class="confirmation-modal">
    <div class="modal-header">
      <h3><i class="fas fa-clipboard-check"></i> CONFIRMA√á√ÉO</h3>
      <div class="modal-subtitle">Revise os dados antes de enviar</div>
    </div>
    
    <div class="modal-content">
      <div class="data-grid">
        <div class="data-item">
          <label>DATA/HORA</label>
          <div class="data-value" id="confirmDataHora"></div>
        </div>
        
        <div class="data-item">
          <label>CAD</label>
          <div class="data-value" id="confirmCAD"></div>
        </div>
        
        <div class="data-item">
          <label>GESTOR</label>
          <div class="data-value" id="confirmGestor"></div>
        </div>
        
        <div class="data-item">
          <label>COLABORADOR</label>
          <div class="data-value" id="confirmColaborador"></div>
        </div>
        
        <div class="data-item">
          <label>TIPO DE FEEDBACK</label>
          <div class="data-value" id="confirmTipo"></div>
        </div>
        
        <div class="data-item">
          <label>ENDERE√áO WMS</label>
          <div class="data-value" id="confirmEndereco"></div>
        </div>
        
        <div class="data-item">
          <label>ENDERE√áO TRATADO?</label>
          <div class="data-value" id="confirmEnderecoTratado"></div>
        </div>
        
        <div class="data-item">
          <label>NOTA</label>
          <div class="data-value large" id="confirmNota"></div>
        </div>
        
        <div class="data-item full-width">
          <label>MENSAGEM</label>
          <div class="data-value" id="confirmMensagem"></div>
        </div>
      </div>
      
      <div class="signature-display">
        <div class="signature-label-text">
          ASSINATURA DO COLABORADOR
        </div>
        <div class="signature-preview-box" id="signaturePreviewContainer">
          <img id="confirmAssinatura" src="" alt="Assinatura" style="display: none;">
          <div class="no-signature" id="noSignatureText">Assinatura n√£o fornecida</div>
        </div>
      </div>
      
      <div class="warning-box">
        <i class="fas fa-exclamation-triangle"></i>
        <div class="warning-content">
          <h4>ATEN√á√ÉO</h4>
          <p>Verifique se todos os dados est√£o corretos antes de confirmar. Ap√≥s o envio, n√£o ser√° poss√≠vel alterar as informa√ß√µes.</p>
        </div>
      </div>
    </div>
    
    <div class="modal-actions">
      <button type="button" class="modal-btn modal-btn-cancel" id="btnCancelar">
        <i class="fas fa-edit"></i> Corrigir Dados
      </button>
      <button type="button" class="modal-btn modal-btn-confirm" id="btnConfirmar">
        <i class="fas fa-check-double"></i> Confirmar Envio
      </button>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="script.js"></script>
</body>
</html>